---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.20.1
  name: bootdependencies.core.bootchain-operator.ruicoelho.dev
spec:
  group: core.bootchain-operator.ruicoelho.dev
  names:
    kind: BootDependency
    listKind: BootDependencyList
    plural: bootdependencies
    singular: bootdependency
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.conditions[?(@.type=='Ready')].status
      name: Ready
      type: string
    - jsonPath: .status.resolvedDependencies
      name: Resolved
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: BootDependency is the Schema for the bootdependencies API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: spec defines the desired state of BootDependency
            properties:
              dependsOn:
                description: |-
                  dependsOn is the list of services that must be reachable before the
                  Deployment with the same name in this namespace is allowed to start.
                items:
                  description: |-
                    ServiceDependency defines a single dependency that must be reachable before the owner can start.
                    Exactly one of `service` or `host` must be specified.
                  properties:
                    host:
                      description: |-
                        host is an external hostname or IP address to wait for.
                        Use this for dependencies outside the cluster (e.g. a managed database, an external API).
                        Mutually exclusive with service.
                      minLength: 1
                      type: string
                    httpExpectedStatuses:
                      description: |-
                        httpExpectedStatuses is a list of HTTP status codes that are considered a healthy response.
                        When omitted, any 2xx status code (200â€“299) is accepted.
                        Use this when a health endpoint returns a non-standard code such as 204 No Content.
                        Only meaningful when httpPath is set.
                      items:
                        format: int32
                        type: integer
                      type: array
                    httpHeaders:
                      description: |-
                        httpHeaders is a list of custom HTTP headers to include in the probe request.
                        Useful for endpoints that require an Authorization header or other custom headers.
                        Only meaningful when httpPath is set.
                      items:
                        description: HTTPHeader describes a custom header to be sent
                          in HTTP(S) probes.
                        properties:
                          name:
                            description: name is the header field name.
                            minLength: 1
                            type: string
                          value:
                            description: value is the header field value.
                            type: string
                        required:
                        - name
                        - value
                        type: object
                      type: array
                    httpMethod:
                      description: |-
                        httpMethod is the HTTP verb to use when httpPath is set (e.g. GET, POST, HEAD).
                        Must be an uppercase HTTP method name. Defaults to GET when omitted.
                        Only meaningful when httpPath is set.
                      pattern: ^[A-Z]+$
                      type: string
                    httpPath:
                      description: |-
                        httpPath is an optional HTTP(S) path to probe instead of a raw TCP check.
                        When set, the controller and init container perform an HTTP GET to
                        {httpScheme}://{target}:{port}{httpPath} and wait until a 2xx response is received.
                        When omitted, a plain TCP connection check is used.
                      pattern: ^/.*
                      type: string
                    httpScheme:
                      description: |-
                        httpScheme is the URL scheme to use when httpPath is set.
                        Must be "http" or "https". Defaults to "http" when omitted.
                        Only meaningful when httpPath is set.
                      enum:
                      - http
                      - https
                      type: string
                    insecure:
                      description: |-
                        insecure controls whether TLS certificate verification is skipped for HTTPS probes.
                        When true, the controller and init container accept any certificate, including
                        self-signed ones. Only meaningful when httpScheme is "https".
                        Defaults to false.
                      type: boolean
                    port:
                      description: port is the TCP port that must be open on the dependency.
                      format: int32
                      maximum: 65535
                      minimum: 1
                      type: integer
                    service:
                      description: |-
                        service is the name of a Kubernetes Service in the same namespace to wait for.
                        Mutually exclusive with host.
                      minLength: 1
                      type: string
                    timeout:
                      default: 60s
                      description: |-
                        timeout is how long to wait for this dependency before giving up.
                        Defaults to 60s if not specified.
                      type: string
                  required:
                  - port
                  type: object
                  x-kubernetes-validations:
                  - message: httpScheme requires httpPath to be set
                    rule: '!has(self.httpScheme) || has(self.httpPath)'
                  - message: insecure requires httpPath to be set
                    rule: '!has(self.insecure) || !self.insecure || has(self.httpPath)'
                  - message: httpMethod requires httpPath to be set
                    rule: '!has(self.httpMethod) || has(self.httpPath)'
                  - message: httpHeaders requires httpPath to be set
                    rule: '!has(self.httpHeaders) || size(self.httpHeaders) == 0 ||
                      has(self.httpPath)'
                  - message: httpExpectedStatuses requires httpPath to be set
                    rule: '!has(self.httpExpectedStatuses) || size(self.httpExpectedStatuses)
                      == 0 || has(self.httpPath)'
                minItems: 1
                type: array
            required:
            - dependsOn
            type: object
          status:
            description: status defines the observed state of BootDependency
            properties:
              conditions:
                description: conditions represent the current state of the BootDependency.
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              resolvedDependencies:
                description: |-
                  resolvedDependencies is a human-readable summary of how many dependencies
                  are currently reachable, e.g. "2/3".
                type: string
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
